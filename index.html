<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>1Drop YaadVibe</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode.js@1.4.4/lib/qrcode.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Changa+One&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <style>
    :root{--green:#009B48;--gold:#FFD700;--black:#000;}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
      font-family:'Inter',sans-serif;
      background:#000 url('/IMG_0039.jpeg') center/cover no-repeat fixed;
      color:#fff;min-height:100dvh;overflow-x:hidden;position:relative;
    }
    .overlay{
      position:fixed;inset:0;
      background:linear-gradient(135deg,rgba(0,0,0,0.04),rgba(0,155,72,0.04));
      backdrop-filter:blur(0.5px);z-index:1;pointer-events:none;
    }
    .flag{
      position:fixed;top:16px;left:16px;width:110px;height:74px;
      background:url('/IMG_0454.png') center/cover no-repeat;
      animation:waveFlow 3s ease-in-out infinite;z-index:10;border-radius:6px;
      box-shadow:0 4px 12px rgba(0,0,0,0.5);
    }
    .flag::after{
      content:"1Drop";font-weight:900;font-size:1.35rem;
      position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
      color:#fff;text-shadow:0 0 8px #000;
    }
    @keyframes waveFlow{0%,100%{transform:rotate(0deg) scale(1);}50%{transform:rotate(2.5deg) scale(1.03);}}
    .container{position:relative;z-index:2;max-width:480px;margin:0 auto;padding:1rem;display:flex;flex-direction:column;min-height:100dvh;}
    .logo{font-family:'Changa One',cursive;font-size:clamp(4.8rem,17vw,7.5rem);font-weight:900;letter-spacing:-3px;text-align:center;margin:2rem 0 0.5rem;}
    .logo span:first-child{background:linear-gradient(135deg,#FF4500,#DC143C);-webkit-background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 0 20px #FF4500);}
    .logo span:last-child{background:linear-gradient(135deg,#FFD700,#FFC107);-webkit-background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 0 25px #FFD700);}
    .logo span{animation:fyahPulse 3s ease-in-out infinite alternate;}
    @keyframes fyahPulse{0%{filter:drop-shadow(0 0 18px #FF4500);transform:scale(1);}100%{filter:drop-shadow(0 0 30px #FFD700);transform:scale(1.03);}}
    .calculator{text-align:center;font-size:2.2rem;font-weight:900;color:var(--gold);background:rgba(0,0,0,0.5);padding:1rem;border-radius:16px;margin:1rem 0;box-shadow:0 0 20px rgba(255,215,0,0.4);}
    #progress{display:flex;justify-content:center;gap:1rem;margin:1.5rem 0;flex-wrap:wrap;font-size:2.2rem;}
    .step{display:none;padding:1.5rem 0;}
    .step.active{display:block;}
    .msg{text-align:center;font-size:1.4rem;margin:1rem 0;color:var(--gold);font-weight:600;}
    .option-card{background:rgba(255,255,255,0.12);border-radius:16px;padding:1.2rem;margin:1rem 0;display:flex;align-items:center;gap:1rem;cursor:pointer;transition:0.3s;border:3px solid transparent;}
    .option-card.selected{border-color:var(--gold);background:rgba(255,215,0,0.2);transform:scale(1.02);}
    .info .name{font-weight:700;font-size:1.2rem;}
    .info .price{color:var(--gold);font-weight:700;}
    .btn{width:100%;padding:1.2rem;margin:1rem 0;border:none;border-radius:16px;font-size:1.35rem;font-weight:900;cursor:pointer;transition:0.3s;}
    .btn.gold{background:var(--gold);color:#000;}
    .btn.green{background:var(--green);color:#fff;}
    .btn.back{position:absolute;top:1rem;left:1rem;background:none;padding:0.5rem;z-index:20;}
    input,select{width:100%;padding:1rem;margin:0.6rem 0;border-radius:16px;border:none;background:rgba(255,255,255,0.15);color:#fff;font-size:1.1rem;}
  </style>
</head>
<body>
  <div class="overlay"></div>
  <div class="flag"></div>
  <div class="container">
    <h1 class="logo"><span>YAAD</span><br><span>VIBE</span></h1>
    <div class="calculator">$<span id="liveTotal">0.00</span></div>
    <div id="progress"></div>

    <!-- STEP 0 -->
    <div id="step0" class="step active">
      <p class="msg">Ready fi di Yaad?</p>
      <button class="btn gold" id="startBtn">Start Booking</button>
    </div>

    <!-- STEP 1 -->
    <div id="step1" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Ya local?</p>
      <div class="option-card" data-value="yes"><div class="info"><div class="name">Yes, local</div></div></div>
      <div class="option-card" data-value="no"><div class="info"><div class="name">No, coming in</div></div></div>
    </div>

    <!-- STEP 2 - FLIGHT ORIGIN (DROPDOWN) -->
    <div id="step2" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Where you flying from?</p>
      <select id="fromCity">
        <option value="">Choose city...</option>
        <optgroup label="Jamaica">
          <option value="kingston">Kingston (KIN)</option>
          <option value="montego-bay">Montego Bay (MBJ)</option>
        </optgroup>
        <optgroup label="Foreign">
          <option value="new-york">New York (JFK)</option>
          <option value="miami">Miami (MIA)</option>
          <option value="toronto">Toronto (YYZ)</option>
          <option value="london">London (LHR)</option>
          <option value="atlanta">Atlanta (ATL)</option>
        </optgroup>
      </select>
      <button class="btn gold" id="btn2">Next</button>
    </div>

    <!-- STEP 2.5 FLIGHTS (only for foreign) -->
    <div id="step25" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Choose Flight (or skip)</p>
      <div id="flight-options"></div>
      <div class="option-card" data-flight="skip"><div class="info"><div class="name">Skip (I’ll book later)</div></div></div>
      <button class="btn gold" id="btnFlight">Next</button>
    </div>

    <!-- STEP 3 DATES -->
    <div id="step3" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Arrival & Departure</p>
      <input type="date" id="arriveDate"><input type="date" id="departDate">
      <p style="margin:1rem 0;font-size:1.3rem;">Nights: <strong><span id="nightCount">1</span></strong></p>
      <button id="minus" class="btn" style="width:auto;display:inline-block;padding:0.8rem 1.2rem;">–</button>
      <button id="plus" class="btn" style="width:auto;display:inline-block;padding:0.8rem 1.2rem;">+</button>
      <p style="margin:1rem 0;">Adults: <input type="number" id="adults" value="2" min="1" style="width:80px;"></p>
      <p>Kids: <input type="number" id="kids" value="0" min="0" style="width:80px;"></p>
      <button class="btn gold" id="btn3">Next</button>
    </div>

    <!-- STEP 4 PARISH -->
    <div id="step4" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Which Parish?</p>
      <div id="parish-options"></div>
      <button class="btn gold" id="parishNext" style="display:none;">Next</button>
    </div>

    <!-- STEP 5 COASTAL / INLAND -->
    <div id="step5" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Coastal or Inland?</p>
      <div class="option-card" data-value="coastal"><div class="info"><div class="name">Coastal</div></div></div>
      <div class="option-card" data-value="inland"><div class="info"><div class="name">Inland</div></div></div>
      <button class="btn gold" id="btnVibe">Next</button>
    </div>

    <!-- STEP 6 STAY -->
    <div id="step6" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Choose Your Stay</p>
      <div id="stay-options"></div>
      <button class="btn gold" id="btnStay">Next</button>
    </div>

    <!-- STEP 7 TRANSPORT -->
    <div id="step7" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Add Transport (optional)</p>
      <div id="transport-options"></div>
      <button class="btn gold" id="btnTransport">Next</button>
    </div>

    <!-- STEP 8 TOURS -->
    <div id="step8" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Add Tours (optional)</p>
      <div id="tour-options"></div>
      <button class="btn gold" id="btnTours">Show My Package</button>
    </div>

    <!-- SUMMARY -->
    <div id="summary" class="step">
      <button class="btn back"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg></button>
      <p class="msg">Your YaadVibe Package</p>
      <div id="summary-items" style="margin:2rem 0;font-size:1.2rem;"></div>
      <div class="calculator">Total: $<span id="total">0.00</span></div>
      <button class="btn gold" id="btnPay" style="display:none;margin:1.5rem 0;">Pay with TON Wallet</button>
      <button class="btn green" id="btnTip" style="display:none;font-size:1.5rem;padding:1.4rem;">
        Tip di Vibe $5
      </button>
      <div id="qr-area" style="margin:2rem 0;"></div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const PARISH_TOWNS = {"clarendon":"May Pen","hanover":"Lucea","kingston":"Kingston","manchester":"Mandeville","portland":"Port Antonio","saint-andrew":"Half Way Tree","saint-ann":"St. Ann’s Bay","saint-catherine":"Spanish Town","saint-elizabeth":"Black River","saint-james":"Montego Bay","saint-mary":"Port Maria","saint-thomas":"Morant Bay","trelawny":"Falmouth","westmoreland":"Savanna-la-Mar"};
  const ALL_PARISHES = Object.keys(PARISH_TOWNS);

  const LIVE_DATA = {
    flights:{default:[{"airline":"JetBlue","code":"B6231","price":380},{"airline":"American","code":"AA1347","price":420}]},
    accommodations:{default:[{"name":"Sandals Montego Bay","price":320,"img":"/sandals.jpg","type":"coastal"},{"name":"Jakes Hotel","price":280,"img":"/jakes.jpg","type":"coastal"},{"name":"Ian Fleming Villas","price":450,"img":"/ian.jpg","type":"inland"}]},
    transport:{default:[{"name":"Private Transfer","price":80},{"name":"Knutsford Express","price":35}]},
    tours:{default:[{"name":"Dunn’s River","price":65},{"name":"Blue Hole","price":55}]}
  };

  let state = {from:'',arrive:'',depart:'',parish:'',vibe:'',stay:null,transport:[],tours:[],nights:1,adults:2,kids:0,isLocal:false,flight:null};
  let total = 0;
  let currentStep = 0;

  const updateCalc = () => {
    total = 0;
    if(state.stay){const base=state.stay.price*state.nights;const extra=(state.adults>2?(state.adults-2)*50:0);total+=base+extra+Math.round(base*0.05);}
    state.transport.forEach(t=>total+=t.price);
    state.tours.forEach(t=>total+=t.price);
    if(state.flight)total+=state.flight.price;
    document.getElementById('liveTotal').textContent=total.toFixed(2);
    document.getElementById('total').textContent=total.toFixed(2);
  };

  const next = n => {document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));const id=n===2.5?'step25':n===9?'summary':`step${n}`;document.getElementById(id).classList.add('active');currentStep=n;updateProgress();};
  const back = () => {const s=[0,1,2,2.5,3,4,5,6,7,8,9];const i=s.indexOf(currentStep);if(i>0)next(s[i-1]);};

  const updateProgress = () => {
    const p=document.getElementById('progress');p.innerHTML='';
    const icons=['Jamaican flag','Airplane','Calendar','Map','Wave','Hotel','Car','Star','Wallet'];
    icons.forEach((e,i)=>{const s=document.createElement('span');s.textContent=e;if(i<currentStep)s.style.opacity='1';if(i===currentStep)s.style.transform='scale(1.4)';p.appendChild(s);});
  };

  const renderParishes = () => {const c=document.getElementById('parish-options');c.innerHTML='';ALL_PARISHES.forEach(p=>{const name=p.replace(/-/g,' ').replace(/\b\w/g,l=>l.toUpperCase());const card=document.createElement('div');card.className='option-card';card.innerHTML=`<div class="info"><div class="name">${name} (${PARISH_TOWNS[p]})</div></div>`;
      card.onclick = () => {
        c.querySelectorAll('.option-card').forEach(x => x.classList.remove('selected'));
        card.classList.add('selected');
        state.parish = p;
        document.getElementById('parishNext').style.display = 'block';
      };
      c.appendChild(card);
    });
  };

  const loadStays = () => {
    const c = document.getElementById('stay-options');
    c.innerHTML = '<p style="text-align:center;color:#aaa">Finding your vibe...</p>';
    setTimeout(() => {
      c.innerHTML = '';
      const items = LIVE_DATA.accommodations.default.filter(i => !state.vibe || i.type === state.vibe);
      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'option-card';
        card.innerHTML = `<img src="${item.img}" onerror="this.src='/IMG_0039.jpeg'" style="width:70px;height:70px;border-radius:8px;"><div class="info"><div class="name">${item.name}</div><div class="price">$${item.price}/night</div></div>`;
        card.onclick = () => {
          c.querySelectorAll('.option-card').forEach(x => x.classList.remove('selected'));
          card.classList.add('selected');
          state.stay = item;
          updateCalc();
        };
        c.appendChild(card);
      });
    }, 600);
  };

  const loadTransport = () => {
    const c = document.getElementById('transport-options'); c.innerHTML = '';
    LIVE_DATA.transport.default.forEach(t => {
      const card = document.createElement('div');
      card.className = 'option-card';
      card.innerHTML = `<div class="info"><div class="name">${t.name}</div><div class="price">$${t.price}</div></div>`;
      card.onclick = () => {
        card.classList.toggle('selected');
        if (card.classList.contains('selected')) state.transport.push(t);
        else state.transport = state.transport.filter(x => x.name !== t.name);
        updateCalc();
      };
      c.appendChild(card);
    });
  };

  const loadTours = () => {
    const c = document.getElementById('tour-options'); c.innerHTML = '';
    LIVE_DATA.tours.default.forEach(t => {
      const card = document.createElement('div');
      card.className = 'option-card';
      card.innerHTML = `<div class="info"><div class="name">${t.name}</div><div class="price">$${t.price}</div></div>`;
      card.onclick = () => {
        card.classList.toggle('selected');
        if (card.classList.contains('selected')) state.tours.push(t);
        else state.tours = state.tours.filter(x => x.name !== t.name);
        updateCalc();
      };
      c.appendChild(card);
    });
  };

  const loadFlights = () => {
    const c = document.getElementById('flight-options'); c.innerHTML = '';
    LIVE_DATA.flights.default.forEach(f => {
      const card = document.createElement('div');
      card.className = 'option-card';
      card.innerHTML = `<div class="info"><div class="name">${f.airline} ${f.code}</div><div class="price">$${f.price}</div></div>`;
      card.onclick = () => {
        c.querySelectorAll('.option-card').forEach(x => x.classList.remove('selected'));
        card.classList.add('selected');
        state.flight = f;
      };
      c.appendChild(card);
    });
  };

  const showSummary = () => {
    const div = document.getElementById('summary-items'); div.innerHTML = '';
    const add = (label, price) => {
      div.innerHTML += `<div style="display:flex;justify-content:space-between;padding:0.8rem 0;border-bottom:1px solid rgba(255,255,255,0.2);"><span>${label}</span><strong style="color:#FFD700">$${price}</strong></div>`;
    };
    if (state.stay) {
      const base = state.stay.price * state.nights;
      const fee = Math.round(base * 0.05);
      add(`${state.stay.name} (${state.nights} nights) + service`, base + fee);
    }
    state.transport.forEach(t => add(t.name, t.price));
    state.tours.forEach(t => add(t.name, t.price));
    if (state.flight) add(`${state.flight.airline} Flight`, state.flight.price);
    document.getElementById('btnPay').style.display = 'block';
    document.getElementById('btnTip').style.display = 'block';
    next(9);
  };

  // EVENT LISTENERS
  document.getElementById('startBtn').onclick = () => next(1);

  document.getElementById('step1').addEventListener('click', e => {
    const card = e.target.closest('.option-card');
    if (card) {
      document.querySelectorAll('#step1 .option-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
      state.isLocal = card.dataset.value === 'yes';
      next(2);
    }
  });

  document.getElementById('btn2').onclick = () => {
    state.from = document.getElementById('fromCity').value;
    if (!state.from) return alert("Choose your city!");
    if (!state.isLocal) { loadFlights(); next(2.5); } else next(3);
  };

  document.getElementById('step25').addEventListener('click', e => {
    if (e.target.closest('[data-flight="skip"]')) {
      document.querySelectorAll('#step25 .option-card').forEach(c => c.classList.remove('selected'));
      e.target.closest('.option-card').classList.add('selected');
      state.flight = null;
    }
  });

  document.getElementById('btnFlight').onclick = () => next(3);

  document.getElementById('minus').onclick = () => { if (state.nights > 1) { state.nights--; document.getElementById('nightCount').textContent = state.nights; updateCalc(); }};
  document.getElementById('plus').onclick  = () => { state.nights++; document.getElementById('nightCount').textContent = state.nights; updateCalc(); };
  document.getElementById('adults').onchange = e => { state.adults = +e.target.value; updateCalc(); };
  document.getElementById('kids').onchange   = e => { state.kids = +e.target.value; updateCalc(); };

  document.getElementById('btn3').onclick = () => {
    state.arrive = document.getElementById('arriveDate').value;
    state.depart = document.getElementById('departDate').value;
    if (!state.arrive || !state.depart) return alert("Choose both dates!");
    const nights = Math.round((new Date(state.depart) - new Date(state.arrive)) / 86400000);
    if (nights > 0) { state.nights = nights; document.getElementById('nightCount').textContent = nights; }
    next(4); renderParishes();
  };

  document.getElementById('parishNext').onclick = () => { if (!state.parish) return alert("Choose parish!"); next(5); };

  document.getElementById('step5').addEventListener('click', e => {
    const card = e.target.closest('.option-card');
    if (card) {
      document.querySelectorAll('#step5 .option-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
      state.vibe = card.dataset.value;
    }
  });

  document.getElementById('btnVibe').onclick = () => {
    if (!state.vibe) return alert("Choose Coastal or Inland!");
    loadStays(); next(6);
  };

  document.getElementById('btnStay').onclick = () => {
    if (!state.stay) return alert("Choose your stay!");
    loadTransport(); next(7);
  };

  document.getElementById('btnTransport').onclick = () => { loadTours(); next(8); };
  document.getElementById('btnTours').onclick = showSummary;

  document.querySelectorAll('.btn.back').forEach(b => b.onclick = e => { e.stopPropagation(); back(); });

  updateProgress();
});
</script>
</body>
</html>
