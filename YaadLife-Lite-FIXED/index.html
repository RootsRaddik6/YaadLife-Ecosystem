<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YaadLife – Book Your Jamaica Vibes</title>
  <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="data:,">
  <style>
    :root{--green:#28a745;--dark:#1a1a1a;--gray:#6c757d}
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Inter',sans-serif;background:#f4f4f4;color:#333;line-height:1.6}
    .container{max-width:900px;margin:0 auto;padding:20px}
    .hero img{width:100%;border-radius:16px;margin-bottom:20px;box-shadow:0 8px 30px rgba(0,0,0,.15);display:block}
    h1,h2{font-weight:700;color:var(--dark);margin:24px 0 16px}
    h1{font-size:1.8rem}
    h2{font-size:1.4rem}
    .step{display:none;padding:20px;background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.08)}
    .step.active{display:block}
    button{background:var(--green);color:white;border:none;padding:14px 24px;margin:16px 0 8px;font-size:16px;border-radius:12px;cursor:pointer;width:100%}
    button:hover{background:#218838}
    .option-card{display:flex;align-items:center;padding:14px;border:2px solid transparent;border-radius:12px;margin:8px 0;cursor:pointer;transition:.2s;background:#fafafa}
    .option-card:hover{border-color:var(--green)}
    .option-card.selected{border-color:var(--green);background:#e8f5e9}
    .option-card img{width:80px;height:80px;object-fit:cover;border-radius:8px;margin-right:12px}
    .option-card .info{flex:1}
    .option-card .name{font-weight:600;font-size:1.1rem}
    .option-card .price{color:var(--green);font-weight:700;font-size:1.1rem}
    #summary-items .item{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid #eee}
    .total{font-size:1.4rem;font-weight:700;margin:20px 0}
    .qr-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:16px;margin-top:20px}
    .qr-item{text-align:center}
    .qr-item p{font-size:0.9rem;margin-top:6px;color:var(--gray)}
    #start-button{max-width:500px;margin:30px auto;padding:18px;font-size:1.2rem}
  </style>
</head>
<body>
<div class="container">
  <div class="hero">
    <img src="https://images.unsplash.com/photo-1506929562872-bb421503ef21?w=1200&fit=crop" alt="Jamaica Vibes">
  </div>

  <!-- All steps unchanged until tours/transport -->
  <div id="step0" class="step active">
    <h1>How can we help you book your vacation package?</h1>
    <button id="start-button">Start Building</button>
  </div>

  <!-- Steps 1–7 same as before (omitted for brevity – keep them exactly as in previous version) -->
  <div id="step1" class="step"> <!-- ... same ... --> </div>
  <div id="step2" class="step"> <!-- ... same ... --> </div>
  <div id="step3" class="step"> <!-- ... same ... --> </div>
  <div id="step4" class="step"><h2>Which parish will you stay in?</h2><div id="parish-options"></div><button id="parish-next" style="display:none;margin-top:20px" onclick="nextStep(5)">Next</button></div>
  <div id="step5" class="step"> <!-- ... same vibe selection ... --> </div>
  <div id="step6" class="step"><h2>Choose your stay</h2><div id="stay-options"></div><button onclick="nextStep(7)">Next to Transport</button></div>

  <!-- STEP 7 – TRANSPORT (NOW FIXED) -->
  <div id="step7" class="step">
    <h2>Need a ride?</h2>
    <div id="transport-options"></div>
    <button onclick="nextStep(8)">Next to Tours</button>
  </div>

  <!-- STEP 8 – TOURS (NOW FIXED WITH FULL CARD STYLE) -->
  <div id="step8" class="step">
    <h2>Add tours (optional)</h2>
    <div id="tour-options"></div>
    <button onclick="showSummary()">Show My Package</button>
  </div>

  <div id="summary" class="step">
    <h2>Your YaadLife Package</h2>
    <div id="summary-items"></div>
    <div class="total">Total: $<span id="total">0</span> USD</div>
    <button onclick="payNow()">Pay & Generate SBT / QR</button>
    <div id="qr-area"></div>
  </div>
</div>

<script>
const MOCK = { /* ... same MOCK data as before ... */ 
  accommodations: { kingston: [ /* ... */ ], "st-andrew": [ /* ... */ ] },
  transport: { kingston: [{name:"Lynk Airport → City",price:25},{name:"JUTC Bus",price:2}] },
  tours: { kingston: [{name:"Bob Marley Museum",price:30},{name:"Devon House Tour",price:20}] }
};

let state = { from:'', arrive:'', parish:'', vibe:'', stay:null, transport:[], tours:[] };
const parishes = ["kingston","st-andrew","st-thomas","portland","st-mary","st-ann","trelawny","st-james","hanover","westmoreland","st-elizabeth","manchester","clarendon","st-catherine"];

function nextStep(n) {
  document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
  const target = n === 9 ? document.getElementById('summary') : document.getElementById('step' + n);
  if (target) target.classList.add('active');
  if (n === 4) renderParishes();
  if (n === 7) loadTransport();
  if (n === 8) loadTours();
}

/* ... renderParishes(), loadStays(), showSummary(), payNow() – unchanged from previous working version ... */

/* ←←← THE ONLY TWO FUNCTIONS THAT WERE BROKEN →→→ */
function loadTransport() {
  const container = document.getElementById('transport-options');
  container.innerHTML = '';
  (MOCK.transport[state.parish] || []).forEach(t => {
    const card = document.createElement('div');
    card.className = 'option-card';
    card.innerHTML = `
      <div class="info">
        <div class="name">${t.name}</div>
        <div class="price">$${t.price}</div>
      </div>
    `;
    card.onclick = () => {
      card.classList.toggle('selected');
      if (card.classList.contains('selected')) {
        state.transport = state.transport.filter(x => x.name !== t.name).concat(t);
      } else {
        state.transport = state.transport.filter(x => x.name !== t.name);
      }
    };
    container.appendChild(card);
  });
}

function loadTours() {
  const container = document.getElementById('tour-options');
  container.innerHTML = '';
  (MOCK.tours.kingston || []).forEach(t => {
    const card = document.createElement('div');
    card.className = 'option-card';
    card.innerHTML = `
      <div class="info">
        <div class="name">${t.name}</div>
        <div class="price">$${t.price}</div>
      </div>
    `;
    card.onclick = () => {
      card.classList.toggle('selected');
      if (card.classList.contains('selected')) {
        state.tours = state.tours.filter(x => x.name !== t.name).concat(t);
      } else {
        state.tours = state.tours.filter(x => x.name !== t.name);
      }
    };
    container.appendChild(card);
  });
}

/* Rest of init code – unchanged */
document.getElementById('start-button').onclick = () => nextStep(1);
/* ... all other event listeners from previous version ... */
</script>
</body>
</html>
